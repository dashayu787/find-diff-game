<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>97 Encontre as Diferen√ßas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #f0f0f0;
      height: 100%;
      font-family: Arial, sans-serif;
    }
    #game-container {
      width: 100vw;
      height: 100vh;
    }
    canvas {
      display: block;
      width: 100% !important;
      height: 100% !important;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
  <script>eruda.init();</script>
</head>
<body>
  <div id="game-container"></div>
  <script>
    const BASE_WIDTH = 360;
    const BASE_HEIGHT = 720;

    const config = {
      type: Phaser.AUTO,
      scale: {
        mode: Phaser.Scale.FIT,
        autoCenter: Phaser.Scale.CENTER_BOTH,
        width: BASE_WIDTH,
        height: BASE_HEIGHT
      },
      parent: 'game-container',
      scene: { preload, create, update }
    };

    let timerText;
    let scoreText;
    let titleText;
    let timeLeft = 60;
    let score = 0;
    let differencePoints = [
      { x: 100, y: 120 },
      { x: 250, y: 300 },
      { x: 180, y: 180 }
    ];
    let foundPoints = [];

    const game = new Phaser.Game(config);

    function preload() {
      this.load.image('topImage', 'https://cdn.jsdelivr.net/gh/dashayu787/my-image-cdn/img/level1_a.png.png');
      this.load.image('bottomImage', 'https://cdn.jsdelivr.net/gh/dashayu787/my-image-cdn/img/level1_b.png.png');
      this.load.atlas('flares', 'https://labs.phaser.io/assets/particles/flares.png', 'https://labs.phaser.io/assets/particles/flares.json');
    }

    function create() {
      const scene = this;
      const sw = this.scale.width;
      const sh = this.scale.height;

      const scaleX = sw / BASE_WIDTH;
      const scaleY = sh / BASE_HEIGHT;

      this.add.image(sw / 2, sh * 0.25, 'topImage')
          .setDisplaySize(sw, sh * 0.45);

      this.add.image(sw / 2, sh * 0.75, 'bottomImage')
          .setDisplaySize(sw, sh * 0.45);

      timerText = this.add.text(sw * 0.05, sh * 0.48, 'Tempo: 60', {
        fontSize: '16px', fill: '#2e7d32', backgroundColor: '#c8e6c9', padding: 6
      }).setOrigin(0);

      titleText = this.add.text(sw * 0.5, sh * 0.48, '97 Diferen√ßas', {
        fontSize: '18px', fill: '#1a237e', backgroundColor: '#bbdefb', padding: 6
      }).setOrigin(0.5);

      scoreText = this.add.text(sw * 0.95, sh * 0.48, 'Pontua√ß√£o: 0', {
        fontSize: '16px', fill: '#2e7d32', backgroundColor: '#c8e6c9', padding: 6
      }).setOrigin(1, 0);

      this.input.on('pointerdown', (pointer) => {
        const clickedX = pointer.x / scaleX;
        const clickedY = pointer.y / scaleY;

        for (let i = 0; i < differencePoints.length; i++) {
          const pt = differencePoints[i];
          const dx = Math.abs(clickedX - pt.x);
          const dyTop = Math.abs(clickedY - pt.y);
          const dyBottom = Math.abs(clickedY - (pt.y + 360));

          if (dx < 25 && (dyTop < 25 || dyBottom < 25) && !foundPoints.includes(i)) {
            foundPoints.push(i);
            score++;
            scoreText.setText('Pontua√ß√£o: ' + score);

            const drawX = pt.x * scaleX;
            const drawY = pt.y * scaleY;

            this.add.circle(drawX, drawY, 10 * scaleX, 0xff0000).setAlpha(0.6);
            this.add.circle(drawX, drawY + sh * 0.5, 10 * scaleX, 0xff0000).setAlpha(0.6);
          }
        }
      });

      this.time.addEvent({
        delay: 1000,
        callback: () => {
          timeLeft--;
          timerText.setText('Tempo: ' + timeLeft);
          if (timeLeft <= 0) {
            this.input.off('pointerdown');

            const endText = this.add.text(sw / 2, sh * 0.5, 'üéâ Fim de jogo!\nPontua√ß√£o: ' + score + ' üéâ', {
              fontSize: '22px', fill: '#ffffff', backgroundColor: '#ff5252', align: 'center', padding: 10
            }).setOrigin(0.5);

            this.tweens.add({
              targets: endText,
              scale: { from: 0, to: 1.2 },
              alpha: { from: 0, to: 1 },
              duration: 600,
              ease: 'Bounce.easeOut'
            });

            // Ê∑ªÂä†Á§ºËä±Á≤íÂ≠êÊïàÊûú
            const particles = this.add.particles('flares');
            const emitter = particles.createEmitter({
              frame: ['red', 'green', 'blue', 'yellow'],
              x: { min: 0, max: sw },
              y: 0,
              lifespan: 2000,
              speedY: { min: 200, max: 400 },
              scale: { start: 0.5, end: 0 },
              quantity: 4,
              blendMode: 'ADD'
            });

            this.time.delayedCall(3000, () => {
              emitter.stop();
            });
          }
        },
        loop: true
      });
    }

    function update() {}
  </script>
</body>
</html>
