<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>97 Encontre as Diferen√ßas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
      background: #e3f2fd;
      color: #1a237e;
    }
    h1 {
      background-color: #bbdefb;
      padding: 10px;
      margin: 0;
    }
    #game-container {
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <h1>97 Encontre as Diferen√ßas</h1>
  <div id="game-container"></div>
  <script>
    const config = {
      type: Phaser.AUTO,
      width: 360,
      height: 550,
      parent: 'game-container',
      scene: { preload, create, update }
    };

    let timerText;
    let scoreText;
    let timeLeft = 60;
    let score = 0;
    let differencePoints = [
      { x: 100, y: 120 },
      { x: 250, y: 200 },
      { x: 180, y: 60 }
    ];
    let foundPoints = [];
    let fireworks = [];

    const game = new Phaser.Game(config);

    function preload() {
      this.load.image('topImage', 'https://cdn.jsdelivr.net/gh/dashayu787/my-image-cdn/img/level1_a.png.png');
      this.load.image('bottomImage', 'https://cdn.jsdelivr.net/gh/dashayu787/my-image-cdn/img/level1_b.png.png');
      this.load.image('spark', 'https://labs.phaser.io/assets/particles/yellow.png');
    }

    function create() {
      const scene = this;
      this.add.image(180, 125, 'topImage').setDisplaySize(360, 250);
      this.add.image(180, 375, 'bottomImage').setDisplaySize(360, 250);

      timerText = this.add.text(60, 260, 'Tempo: 60', { fontSize: '18px', fill: '#1a237e' });
      scoreText = this.add.text(220, 260, 'Pontua√ß√£o: 0', { fontSize: '18px', fill: '#1a237e' });

      this.input.on('pointerdown', (pointer) => {
        const clickedX = pointer.x;
        const clickedY = pointer.y;
        for (let i = 0; i < differencePoints.length; i++) {
          const pt = differencePoints[i];
          const dx = Math.abs(clickedX - pt.x);
          const dyTop = Math.abs(clickedY - pt.y);
          const dyBottom = Math.abs(clickedY - (pt.y + 250));

          if (dx < 25 && (dyTop < 25 || dyBottom < 25) && !foundPoints.includes(i)) {
            foundPoints.push(i);
            score++;
            scoreText.setText('Pontua√ß√£o: ' + score);
            this.add.circle(pt.x, pt.y, 10, 0xff0000).setAlpha(0.6);
            this.add.circle(pt.x, pt.y + 250, 10, 0xff0000).setAlpha(0.6);
          }
        }
      });

      this.time.addEvent({
        delay: 1000,
        callback: () => {
          timeLeft--;
          timerText.setText('Tempo: ' + timeLeft);
          if (timeLeft <= 0) {
            this.input.off('pointerdown');

            const endText = this.add.text(180, 290, 'üéâ Fim de jogo!\nPontua√ß√£o: ' + score + ' üéâ', {
              fontSize: '22px',
              fill: '#d32f2f',
              fontStyle: 'bold',
              align: 'center'
            }).setOrigin(0.5);

            this.tweens.add({
              targets: endText,
              scale: { from: 0, to: 1.2 },
              alpha: { from: 0, to: 1 },
              duration: 500,
              ease: 'Bounce.easeOut'
            });

            for (let i = 0; i < 5; i++) {
              const emitter = this.add.particles(0, 0, 'spark', {
                x: Phaser.Math.Between(60, 300),
                y: Phaser.Math.Between(100, 450),
                speed: { min: 100, max: 300 },
                angle: { min: 0, max: 360 },
                scale: { start: 0.6, end: 0 },
                lifespan: 1000,
                quantity: 20,
                blendMode: 'ADD'
              });
              fireworks.push(emitter);
            }
          }
        },
        loop: true
      });
    }

    function update() {}
  </script>
</body>
</html>
